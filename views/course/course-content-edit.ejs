
   <%- include('../header.ejs') %>
   <!-- Layout wrapper -->
   <div class="layout-wrapper layout-content-navbar">
     <div class="layout-container">
       <!-- Menu -->
       <%- include('../menu.ejs') %>
       <!-- /Menu -->

       <!-- Layout container -->
       <div class="layout-page">
        <!-- Navbar -->
        <%- include('../navbar.ejs') %>
        <!-- /Navbar -->

         <!-- Content wrapper -->
         <div class="content-wrapper">

          <h4 class="container mt-4"><strong>강의 콘탠츠 편집</strong></h4>

          <div class="container mt-3">
            <form action="/course/content/add" method="POST" onsubmit="validateMyForm();">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label> 강의 분류 </label>
                                <select name="maincourse_category" id="maincourse_category">
                                <!-- Select to main Course list -->
                                <span>강의 분류 (미완성)</span>
                                <!-- <input type="text" class="form-control" name="title"> -->
                                <span>강의 차수 (미완성)</span>
                            </div>
                            <div class="form-group">
                                <label>강의 주제</label>
                                <input type="text" class="form-control" name="subcourse_title" value="<%= subcourse.title %>">
                            </div>
                            <div class="form-group">
                                <div>비디오 분류</div>
                                <label>
                                    <input type="radio" id="video_option" name="video_option" value="youtube" onchange="handleChange(event)" checked>
                                    Youtube
                                </label>
                                <label>
                                    <input type="radio" id="video_option" name="video_option" value="vimeo" onchange="handleChange(event)">
                                    Vimeo
                                </label>
                            </div>
                            <div class="form-group">
                                <label>강의 영상 링크</label>
                                <input type="url" id="subcourse_link" class="form-control" name="subcourse_link" placeholder="강의영상 URL을 입력해주세요." onchange="printVideo()" value="<%= subcourse.link %>">
                            </div>
                            <div class="alert alert-danger" role="alert" style="display: none;">
                                강의분류와 영상 링크가 일치하는지 확인해주세요.
                            </div>
                        </div>
                        <div class="col">
                            <div id="player"><i class="fa-solid fa-video-slash"></i></div>

                        </div>
                    </div>
                </div>
              <div class="form-group">                
                <label>내용</label>
                <p class="hidden-data" style="display: none;"><%= subcourse.content %></p>
                <textarea id="summernote"  name="note_content" ></textarea>
              </div>
              <button type="submit" class="submit-btn btn btn-outline-secondary">Submit</button>
            </form>
          </div>
          
          <script src="https://www.youtube.com/iframe_api"></script>
          <script src="https://player.vimeo.com/api/player.js"></script>
          <script src="/assets/js/video.js"></script>
          <script>
            $( document ).ready(function() {
              var data = $('.hidden-data').text();
             $('#summernote').summernote('pasteHTML', data);
           });
              function handleChange(event){
                const urlInput = document.getElementById('subcourse_link');
                const urlStr = urlInput.value.toString();
                const videoOption = event.target.value;

                if(urlInput.value)
                {
                    urlInput.value = "";
                    initVideoPlayer();
                }
              }

            const courseSelect = document.getElementById('maincourse_category');
            const totalSubcourseSelect = document.getElementById('subcourses_indexno');

            courseSelect.addEventListener('change', () => {
                
                const optionElement = courseSelect.options[courseSelect.selectedIndex];
                const lessonsCount = optionElement.getAttribute('data-max');
                totalSubcourseSelect.innerHTML = '';

                for (let i = 0; i <= lessonsCount; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i;
                    totalSubcourseSelect.appendChild(option);
                }
            });

            $('#summernote').summernote({
              placeholder: '',
              tabsize: 2,
               // 에디터 높이
              height: 250,
              // 에디터 한글 설정
              lang: "ko-KR",
              // 에디터에 커서 이동 (input창의 autofocus라고 생각하시면 됩니다.)
              focus : true,
              toolbar: [
                  // 글꼴 설정
                  ['fontname', ['fontname']],
                  // 글자 크기 설정
                  ['fontsize', ['fontsize']],
                  // 굵기, 기울임꼴, 밑줄,취소 선, 서식지우기
                  ['style', ['bold', 'italic', 'underline','strikethrough', 'clear']],
                  // 글자색
                  ['color', ['forecolor','color']],
                  // 표만들기
                  ['table', ['table']],
                  // 글머리 기호, 번호매기기, 문단정렬
                  ['para', ['ul', 'ol', 'paragraph']],
                  // 줄간격
                  ['height', ['height']],
                  // 링크첨부
                  ['insert',['link']],
                ],
              // 추가한 폰트사이즈
              fontSizes: ['8','9','10','11','12','14','16','18','20','22','24','28','30','36','50','72']
            });

            function validateMyForm()
            {
              $('textarea[name="content"]').html($('.summernote').code());
              alert("validations passed");
              return true;
            }
          </script>

           </div>
           <div class="content-backdrop fade"></div>
         </div>
         <!-- Content wrapper -->
       </div>
       <!-- / Layout page -->
     </div>

     <!-- Overlay -->
     <div class="layout-overlay layout-menu-toggle"></div>
   </div>
   <%- include('../footer.ejs') %>
